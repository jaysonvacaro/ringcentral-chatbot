{"version":3,"sources":["../../src/models/Service.js"],"names":["Service","sequelize","define","id","type","Sequelize","INTEGER","autoIncrement","primaryKey","name","STRING","botId","groupId","userId","data","JSON","prototype","check","bot","Bot","findByPk","destroy","group","getGroup","members","indexOf"],"mappings":";;;;;;;AAAA;;AAEA;;AACA;;;;AAEO,MAAMA,OAAO,GAAGC,oBAAUC,MAAV,CAAiB,SAAjB,EAA4B;AACjDC,EAAAA,EAAE,EAAE;AAAE;AACJC,IAAAA,IAAI,EAAEC,mBAAUC,OADd;AAEFC,IAAAA,aAAa,EAAE,IAFb;AAGFC,IAAAA,UAAU,EAAE;AAHV,GAD6C;AAMjDC,EAAAA,IAAI,EAAE;AAAE;AACNL,IAAAA,IAAI,EAAEC,mBAAUK;AADZ,GAN2C;AASjDC,EAAAA,KAAK,EAAE;AAAE;AACPP,IAAAA,IAAI,EAAEC,mBAAUK;AADX,GAT0C;AAYjDE,EAAAA,OAAO,EAAE;AAAE;AACTR,IAAAA,IAAI,EAAEC,mBAAUK;AADT,GAZwC;AAejDG,EAAAA,MAAM,EAAE;AAAE;AACRT,IAAAA,IAAI,EAAEC,mBAAUK;AADV,GAfyC;AAkBjDI,EAAAA,IAAI,EAAE;AAAE;AACNV,IAAAA,IAAI,EAAEC,mBAAUU;AADZ;AAlB2C,CAA5B,CAAhB;;;;AAuBPf,OAAO,CAACgB,SAAR,CAAkBC,KAAlB,GAA0B,kBAAkB;AAC1C,QAAMC,GAAG,GAAG,MAAMC,SAAIC,QAAJ,CAAa,KAAKT,KAAlB,CAAlB;;AACA,MAAI,CAACO,GAAL,EAAU;AACR,UAAM,KAAKG,OAAL,EAAN;AACA;AACD;;AACD,QAAMC,KAAK,GAAG,MAAMJ,GAAG,CAACK,QAAJ,CAAa,KAAKX,OAAlB,CAApB;;AACA,MAAI,CAACU,KAAD,IAAUA,KAAK,CAACE,OAAN,CAAcC,OAAd,CAAsBP,GAAG,CAACf,EAA1B,MAAkC,CAAC,CAAjD,EAAoD;AAClD,UAAM,KAAKkB,OAAL,EAAN;AACD;AACF,CAVD","sourcesContent":["import Sequelize from 'sequelize'\n\nimport sequelize from './sequelize'\nimport { Bot } from './Bot'\n\nexport const Service = sequelize.define('service', {\n  id: { // service ID\n    type: Sequelize.INTEGER,\n    autoIncrement: true,\n    primaryKey: true\n  },\n  name: { // service name\n    type: Sequelize.STRING\n  },\n  botId: { // Glip bot ID\n    type: Sequelize.STRING\n  },\n  groupId: { // Glip group ID\n    type: Sequelize.STRING\n  },\n  userId: { // Glip user ID\n    type: Sequelize.STRING\n  },\n  data: { // all other data associcated with this service\n    type: Sequelize.JSON\n  }\n})\n\nService.prototype.check = async function () {\n  const bot = await Bot.findByPk(this.botId)\n  if (!bot) {\n    await this.destroy()\n    return\n  }\n  const group = await bot.getGroup(this.groupId)\n  if (!group || group.members.indexOf(bot.id) === -1) {\n    await this.destroy()\n  }\n}\n"],"file":"Service.js"}